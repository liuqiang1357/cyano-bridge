var CyanoMobile=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";n.r(t);var r={};function i(e){if("Boolean"===e.type||"Integer"===e.type)return{name:e.name,value:e.value};if("String"===e.type||"ByteArray"===e.type||"Long"===e.type||"Address"===e.type)return{name:e.name,value:e.type+":"+e.value};if("Array"===e.type)return{name:e.name,value:e.value.map(e=>i(e))};if("Map"===e.type){const t={};for(const n of Object.keys(e.value))t[n]=i(e.value[n]);return{name:e.name,value:t}}throw new Error("Invalid parmeter type: "+JSON.stringify(e))}function s(e,t){const n=[];for(const e of t)n.push(i(e));return{operation:e,args:n}}function a(){return Math.random().toString(36).substring(2,10)}n.r(r),n.d(r,"registerClient",function(){return g}),n.d(r,"api",function(){return d});var o=class{constructor(e){this.timeout=3e3,this.version="v1.0.0",this.handlers={},e&&(this.timeout=e),this.injected=!1,this.pendingMsgs=[]}call(e){const t=a();return e.id=t,new Promise((n,r)=>{const i="ontprovider://ont.io?params="+btoa(encodeURIComponent(JSON.stringify(e)));this.sendMessage(i),this.handleMessageEvent(t,n,r,e.action,e.needTimeout)})}invokeRead(){throw new Error("invokeRead not supported yet.")}parseMessage(e){return JSON.parse(decodeURIComponent(atob(e)))}onMessage(e){this.listener&&this.offMessage();const t=t=>{const n=this.parseMessage(t.data);e(n)};window.document.addEventListener("message",t),this.listener=t}offMessage(){window.document.removeEventListener("message",this.listener)}sendMessage(e){this.injected?window.postMessage(e,"*"):this.checkInterval?this.pendingMsgs.push(e):this.checkInterval=window.setInterval(()=>{window.originalPostMessage&&(window.postMessage(e,"*"),this.injected=!0,this.pendingMsgs.forEach(e=>{window.postMessage(e,"*")}),window.clearInterval(this.checkInterval))},100)}handleMessageEvent(e,t,n,r,i=!1){const s=this,a=function(e){const i=e.data;i||n(e);const o=s.parseMessage(i);o.id||n("No message id"),s.handlers[o.id]||n("No message handler"),o.id===a.id&&(document.removeEventListener("message",s.handlers[o.id]),delete s.handlers[o.id],o.action===r?t(o):n(o))};a.id=e,this.handlers[e]=a,document.addEventListener("message",this.handlers[e]),i&&setTimeout(()=>{n("Time out")},this.timeout)}};let c;function g(e=3e3){c=new o(e)}async function u(e){return c.call(e)}const p={invoke(e){if(!e.scriptHash||!e.operation||!e.args)throw new Error("Invalid params.");if(!e.payer)throw new Error("No payer.");e.config||(e.config={login:!0,message:"",url:""});const t=s(e.operation,e.args);return u({action:"invoke",version:"1.0.0",params:{login:e.config.login,url:e.config.url,message:e.config.message,invokeConfig:{contractHash:e.scriptHash,functions:[t],payer:e.payer,gasPrice:e.gasPrice?e.gasPrice:500,gasLimit:e.gasLimit?e.gasLimit:2e4}}})},invokeRead(e){if(!e.scriptHash||!e.operation||!e.args)throw new Error("Invalid params.");e.config||(e.config={login:!0,message:"",url:""});const t=s(e.operation,e.args);return u({action:"invokeRead",version:"1.0.0",params:{login:e.config.login,url:e.config.url,message:e.config.message,invokeConfig:{contractHash:e.scriptHash,functions:[t],payer:e.payer,gasPrice:e.gasPrice?e.gasPrice:500,gasLimit:e.gasLimit?e.gasLimit:2e4}}})},invokePasswordFree(e){if(!e.scriptHash||!e.operation||!e.args||0===e.args.length)throw new Error("Invalid params.");if(!e.payer)throw new Error("No payer.");e.config||(e.config={login:!0,message:"",url:""});const t=s(e.operation,e.args);return u({action:"invokePasswordFree",version:"1.0.0",params:{login:e.config.login,url:e.config.url,message:e.config.message,invokeConfig:{contractHash:e.scriptHash,functions:[t],payer:e.payer,gasPrice:e.gasPrice?e.gasPrice:500,gasLimit:e.gasLimit?e.gasLimit:2e4}}})}},d={asset:{getAccount:e=>u({action:"getAccount",version:"1.0.0",params:e,needTimeout:!0}),transfer({from:e,to:t,asset:n,amount:r,gasPrice:i,gasLimit:s}){const a={scriptHash:"ONT"===n?"0100000000000000000000000000000000000000":"0200000000000000000000000000000000000000",operation:"transfer",args:[{name:"from",type:"Address",value:e},{name:"to",type:"Address",value:t},{name:"amount",type:"Long",value:r}],gasPrice:500,gasLimit:2e4,payer:e};return p.invoke(a)}},identity:{getIdentity:e=>u({action:"getIdentity",version:"1.0.0",params:e,needTimeout:!0}),authentication:e=>u({action:"authentication",version:"1.0.0",params:e}),authorization:e=>u({action:"authorization",version:"1.0.0",params:e}),registerOntId({ontid:e,publicKey:t,payer:n,gasPrice:r,gasLimit:i}){const s={scriptHash:"0300000000000000000000000000000000000000",operation:"regIDWithPublicKey",args:[{name:"ontid",type:"String",value:e},{name:"pk",type:"ByteArray",value:t}],gasPrice:500,gasLimit:2e4,payer:n};return p.invoke(s)},getDDO(e){const t={scriptHash:"0300000000000000000000000000000000000000",operation:"getDDO",args:[{name:"ontid",type:"String",value:e}],gasPrice:500,gasLimit:2e4};return p.invokeRead(t)}},message:{signMessage:e=>u({action:"signMessage",version:"1.0.0",params:e,needTimeout:!1}),login(e){if(!e.message||"string"!=typeof e.message)throw new Error("Parameter for login must contain a message.");return e.type||(e.type="account"),u({action:"login",version:"1.0.0",params:e,needTimeout:!1})}},smartContract:p,qrcode:{login(e){if("ontid"!==e.type&&"account"!==e.type)throw new Error("Invalid parameter type "+e.type);const t={action:"login",version:"1.0.0",id:a(),params:e};return JSON.stringify(t)},invoke(e){const t={action:"invoke",version:"1.0.0",id:a(),params:e};return JSON.stringify(t)}},provider:{getProvider:()=>u({action:"getProvider",version:"1.0.0",needTimeout:!0})}};n.d(t,"client",function(){return r})}]);
//# sourceMappingURL=browser.js.map